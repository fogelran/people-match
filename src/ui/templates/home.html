<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>People Match</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050915;
            --panel: rgba(255, 255, 255, 0.04);
            --panel-strong: rgba(255, 255, 255, 0.08);
            --cyan: #34e2e2;
            --violet: #9b8cff;
            --rose: #ff7edb;
            --text: #e8edf7;
            --muted: #aab3c8;
            --border: rgba(255, 255, 255, 0.08);
            --shadow: 0 24px 80px rgba(0, 0, 0, 0.45);
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: 'Space Grotesk', system-ui, -apple-system, sans-serif;
            background: radial-gradient(circle at 10% 10%, rgba(52, 226, 226, 0.12), transparent 35%),
                        radial-gradient(circle at 80% 0%, rgba(155, 140, 255, 0.14), transparent 35%),
                        linear-gradient(135deg, #060b18, #0b1226 50%, #060b18);
            color: var(--text);
            min-height: 100vh;
        }
        .shell {
            max-width: 1100px;
            margin: 0 auto;
            padding: 32px 20px 80px;
        }
        h1, h2, h3, h4 {
            margin: 0;
            color: var(--text);
        }
        p { color: var(--muted); }
        a { color: inherit; text-decoration: none; }
        .glass {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 18px;
            box-shadow: var(--shadow);
            backdrop-filter: blur(12px);
        }
        .hero {
            padding: 28px;
            margin-bottom: 18px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            background: linear-gradient(120deg, rgba(52, 226, 226, 0.16), rgba(155, 140, 255, 0.18), rgba(255, 126, 219, 0.1));
            border: 1px solid rgba(255, 255, 255, 0.12);
        }
        .eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 14px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.08);
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text);
        }
        .pulse {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--cyan), var(--violet));
            box-shadow: 0 0 12px rgba(52, 226, 226, 0.8);
        }
        .stepper {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
        }
        .step {
            padding: 14px;
            border-radius: 14px;
            border: 1px solid var(--border);
            background: var(--panel);
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .step-number {
            width: 34px;
            height: 34px;
            display: grid;
            place-items: center;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--cyan), var(--violet));
            color: #050915;
            font-weight: 800;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 16px;
        }
        .card {
            padding: 20px;
        }
        label {
            display: block;
            margin-bottom: 6px;
            color: var(--muted);
            font-weight: 600;
        }
        input, textarea, select, button {
            font-family: inherit;
        }
        .field {
            width: 100%;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--panel-strong);
            color: var(--text);
        }
        .field:focus {
            outline: 2px solid rgba(52, 226, 226, 0.3);
            border-color: rgba(52, 226, 226, 0.6);
        }
        .btn {
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-weight: 700;
            cursor: pointer;
            color: #050915;
            background: linear-gradient(135deg, var(--cyan), var(--violet));
            transition: transform 120ms ease, box-shadow 120ms ease;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        }
        .btn:hover { transform: translateY(-1px); }
        .btn.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
            box-shadow: none;
        }
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.08);
            color: var(--text);
            font-weight: 600;
        }
        .progress-track {
            height: 10px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.08);
            overflow: hidden;
            border: 1px solid var(--border);
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--cyan), var(--violet), var(--rose));
        }
        .pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .pill {
            padding: 8px 12px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.08);
            color: var(--text);
            font-size: 0.95rem;
        }
        .muted { color: var(--muted); }
        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 10px;
        }
        .question-chip {
            padding: 12px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--panel);
            color: var(--text);
        }
        .inline-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        .answer-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .small-note { font-size: 0.9rem; color: var(--muted); }
        .two-col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 12px;
        }
        @media (max-width: 640px) {
            .hero { padding: 20px; }
        }
    </style>
</head>
<body>
<div class="shell">
    <header class="hero glass">
        <div class="eyebrow"><span class="pulse"></span> Playful matching steps</div>
        <h1>Sign in, answer one beat at a time, craft your asks, meet your best match.</h1>
        <p>Every step is a micro interaction. Glide through the flow like a mini-game and land on people who fit your answers.</p>
        <div class="stepper">
            <div class="step">
                <div class="step-number">1</div>
                <div>
                    <div class="muted">Sign in</div>
                    <strong>Drop your name + vibe</strong>
                </div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div>
                    <div class="muted">Answer</div>
                    <strong>Yes / No / Skip</strong>
                </div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>
                    <div class="muted">Ask</div>
                    <strong>Your own or pick</strong>
                </div>
            </div>
            <div class="step">
                <div class="step-number">4</div>
                <div>
                    <div class="muted">Match</div>
                    <strong>See best partners</strong>
                </div>
            </div>
        </div>
    </header>

    <section id="step-1" class="glass card" style="margin-bottom: 14px;">
        <div class="inline-form" style="justify-content: space-between;">
            <div>
                <h2>Step 1 · Sign in</h2>
                <p class="muted">We only need a name to start. Add a photo and tagline to personalize the rest of the flow.</p>
            </div>
            <a class="btn secondary" href="#step-2">Skip to next</a>
        </div>
        <form action="{{ url_for('register') }}" method="post" class="grid" style="margin-top: 10px;">
            <div>
                <label for="register-name">Display name</label>
                <input class="field" id="register-name" name="user_name" placeholder="Skyler Nova" required>
            </div>
            <div>
                <label for="register-photo">Profile image URL</label>
                <input class="field" id="register-photo" name="profile_image_url" type="url" placeholder="https://images.example/me.jpg">
            </div>
            <div>
                <label for="register-tagline">Tagline or short bio</label>
                <input class="field" id="register-tagline" name="tagline" placeholder="AI tinkerer · Night runner">
            </div>
            <div style="display: flex; align-items: flex-end;">
                <button class="btn" type="submit">Continue to questions</button>
            </div>
        </form>
    </section>

    <section id="step-2" class="glass card" style="margin-bottom: 14px;">
        <div class="inline-form" style="justify-content: space-between;">
            <div>
                <h2>Step 2 · Answer one by one</h2>
                <p class="muted">We surface one unanswered prompt. Tap yes / no / skip to move forward.</p>
            </div>
            <a class="btn secondary" href="#step-3">Continue</a>
        </div>
        <form action="{{ url_for('index') }}" method="get" class="inline-form" style="margin-top: 12px;">
            <label for="focus-user">Play as</label>
            <input class="field" id="focus-user" name="focus_user" value="{{ focus_user or '' }}" placeholder="Your name">
            <button class="btn secondary" type="submit">Load next question</button>
        </form>

        <div class="grid" style="margin-top: 14px;">
            <div class="glass card">
                <div class="inline-form" style="justify-content: space-between; align-items: center;">
                    <div>
                        <div class="muted small-note">Next prompt</div>
                        <h3>{{ suggested_question or "No open questions right now" }}</h3>
                    </div>
                    <div class="badge">
                        <span class="pulse"></span>
                        <span>{{ answered_count }} / {{ total_questions }} answered</span>
                    </div>
                </div>
                <div class="progress-track" style="margin-top: 10px;">
                    <div class="progress-bar" style="width: {{ progress_percent }}%;"></div>
                </div>
                {% if suggested_question %}
                    <div class="answer-buttons" style="margin-top: 14px;">
                        <form action="{{ url_for('answer_question') }}" method="post">
                            <input type="hidden" name="user_name" value="{{ focus_user }}">
                            <input type="hidden" name="question_text" value="{{ suggested_question }}">
                            <input type="hidden" name="answer_action" value="yes">
                            <button class="btn" type="submit">Yes</button>
                        </form>
                        <form action="{{ url_for('answer_question') }}" method="post">
                            <input type="hidden" name="user_name" value="{{ focus_user }}">
                            <input type="hidden" name="question_text" value="{{ suggested_question }}">
                            <input type="hidden" name="answer_action" value="no">
                            <button class="btn" type="submit">No</button>
                        </form>
                        <form action="{{ url_for('answer_question') }}" method="post">
                            <input type="hidden" name="user_name" value="{{ focus_user }}">
                            <input type="hidden" name="question_text" value="{{ suggested_question }}">
                            <input type="hidden" name="answer_action" value="skip">
                            <button class="btn secondary" type="submit">Skip</button>
                        </form>
                    </div>
                {% elif question_status %}
                    <p class="small-note" style="margin-top: 12px;">{{ question_status }}</p>
                {% else %}
                    <p class="small-note" style="margin-top: 12px;">Sign in and load your name to start answering.</p>
                {% endif %}

                {% if answered_status %}
                    <div style="margin-top: 16px;">
                        <div class="muted small-note">Answered streak</div>
                        <div class="pill-row">
                            {% for question, answered in answered_status.items() %}
                                <span class="pill">{{ "✓" if answered else "…" }} {{ question }}</span>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            </div>
            <div class="glass card">
                <div class="inline-form" style="justify-content: space-between;">
                    <div>
                        <div class="muted small-note">Skipped</div>
                        <h4>{{ skipped_questions|length if skipped_questions is defined else 0 }} parked items</h4>
                    </div>
                    <div class="badge">{{ total_questions }} total prompts live</div>
                </div>
                <div class="question-grid" style="margin-top: 10px;">
                    {% for question in skipped_questions or [] %}
                        <div class="question-chip">
                            <div class="muted small-note">Skipped</div>
                            <div>{{ question }}</div>
                        </div>
                    {% endfor %}
                    {% if (skipped_questions or [])|length == 0 %}
                        <p class="small-note">No skips yet. You are on a roll!</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <section id="step-3" class="glass card" style="margin-bottom: 14px;">
        <div class="inline-form" style="justify-content: space-between;">
            <div>
                <h2>Step 3 · Ask or select</h2>
                <p class="muted">Drop your own yes/no question or choose one from the library with the answer you prefer.</p>
            </div>
            <a class="btn secondary" href="#step-4">Continue</a>
        </div>
        <div class="two-col" style="margin-top: 12px;">
            <form action="{{ url_for('ask_question') }}" method="post" class="glass card">
                <div class="muted small-note">Custom card</div>
                <h4>Create your own prompt</h4>
                <input type="hidden" name="user_name" value="{{ focus_user or '' }}">
                <label for="ask-question">Question text</label>
                <textarea class="field" id="ask-question" name="question_text" rows="2" placeholder="Do you prefer sunrise runs?" required></textarea>
                <div class="inline-form" style="margin-top: 10px;">
                    <label style="margin: 0;">You want them to say</label>
                    <label><input type="radio" name="expected_answer" value="yes" checked> Yes</label>
                    <label><input type="radio" name="expected_answer" value="no"> No</label>
                </div>
                <button class="btn" type="submit" style="margin-top: 12px;">Save custom ask</button>
            </form>

            <form action="{{ url_for('ask_question') }}" method="post" class="glass card">
                <div class="muted small-note">Library pick</div>
                <h4>Select an existing question</h4>
                <input type="hidden" name="user_name" value="{{ focus_user or '' }}">
                <label for="library-question">Question</label>
                <select class="field" id="library-question" name="question_text" required>
                    <option value="" disabled selected>Select a question</option>
                    {% for question in questions %}
                        <option value="{{ question }}">{{ question }}</option>
                    {% endfor %}
                </select>
                <div class="inline-form" style="margin-top: 10px;">
                    <label style="margin: 0;">You want them to say</label>
                    <label><input type="radio" name="expected_answer" value="yes" checked> Yes</label>
                    <label><input type="radio" name="expected_answer" value="no"> No</label>
                </div>
                <button class="btn" type="submit" style="margin-top: 12px;">Add preference</button>
            </form>
        </div>
        {% if user_preferences %}
            <div style="margin-top: 14px;">
                <div class="muted small-note">Your current asks</div>
                <div class="question-grid">
                    {% for question, expected in user_preferences.items() %}
                        <div class="question-chip">
                            <div class="muted small-note">{{ "Expecting yes" if expected else "Expecting no" }}</div>
                            <div>{{ question }}</div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </section>

    <section id="step-4" class="glass card">
        <div class="inline-form" style="justify-content: space-between;">
            <div>
                <h2>Step 4 · See matches</h2>
                <p class="muted">We compare your asks with everyone’s answers and surface the best-fit partners.</p>
            </div>
            <a class="btn secondary" href="#step-1">Restart flow</a>
        </div>

        <div class="grid" style="margin-top: 12px;">
            <div class="glass card">
                <div class="inline-form" style="justify-content: space-between; align-items: center;">
                    <div>
                        <div class="muted small-note">Instant best match</div>
                        <h3>Who fits you best right now?</h3>
                    </div>
                    <div class="badge">Live matching</div>
                </div>
                <form action="{{ url_for('best_match') }}" method="post" class="inline-form" style="margin-top: 10px;">
                    <input class="field" name="user_name" value="{{ focus_user or '' }}" placeholder="Your name" required>
                    <button class="btn" type="submit">Compute</button>
                </form>
                {% if match_name is defined %}
                    {% if match_name %}
                        <p style="margin-top: 10px;">✨ <strong>{{ match_name }}</strong> lines up with your preferences.</p>
                    {% else %}
                        <p class="small-note" style="margin-top: 10px;">No perfect match yet — add or answer a few more questions.</p>
                    {% endif %}
                {% endif %}
            </div>
            <div class="glass card">
                <div class="muted small-note">Quick filter</div>
                <h4>Find people who say yes/no</h4>
                <form action="{{ url_for('search') }}" method="post" class="grid" style="margin-top: 8px;">
                    <input type="hidden" name="user_name" value="{{ focus_user or '' }}">
                    <div>
                        <label for="filter-question">Question</label>
                        <select class="field" id="filter-question" name="question_1">
                            {% for question in questions %}
                                <option value="{{ question }}">{{ question }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label for="filter-answer">Desired answer</label>
                        <select class="field" id="filter-answer" name="answer_1">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: flex-end;">
                        <button class="btn" type="submit">Search</button>
                    </div>
                </form>
                {% if results is defined %}
                    <div style="margin-top: 10px;">
                        {% if results %}
                            <div class="muted small-note">Matches</div>
                            <div class="pill-row">
                                {% for person in results %}
                                    <span class="pill">{{ person }}</span>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="small-note">No matches for that filter yet.</p>
                        {% endif %}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="glass card" style="margin-top: 14px;">
            <div class="inline-form" style="justify-content: space-between;">
                <div>
                    <div class="muted small-note">Live library</div>
                    <h4>{{ questions|length }} questions in play</h4>
                </div>
                <div class="badge">{{ demo_matches | join(', ') if demo_matches else 'No demo matches yet' }}</div>
            </div>
            <div class="question-grid" style="margin-top: 10px;">
                {% for question in questions %}
                    <div class="question-chip">{{ question }}</div>
                {% endfor %}
            </div>
        </div>
    </section>
</div>
</body>
</html>
